{% extends 'tickets/base.html' %}

{% block title %}{{ page_title }}{% endblock %}
{% block page_title %}{{ page_title }}{% endblock %}

{% block breadcrumb %}
<!-- No breadcrumb for customer profile -->
{% endblock %}

{% block content %}
<div class="container-fluid">
  <!-- Profile Header -->
  <div class="row mb-4">
    <div class="col-12 d-flex justify-content-between align-items-center flex-wrap">
      <div>
        <h1 class="h3 mb-0">
          <i class="bi bi-person-circle text-primary me-2"></i>Profil Bilgileri
        </h1>
        <p class="text-muted mb-0">Kişisel bilgilerinizi görüntüleyin ve yönetin</p>
      </div>
      <div class="mt-2 mt-lg-0">
        <a href="/accounts/customer/profile-edit/" class="btn btn-primary">
          <i class="bi bi-pencil me-2"></i>Düzenle
        </a>
      </div>
    </div>
  </div>

  <!-- Profile Content -->
  <div class="row">
    <!-- Personal Information -->
    <div class="col-lg-6 mb-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bi bi-person me-2"></i>Kişisel Bilgiler
          </h5>
        </div>
        <div class="card-body">
          <table class="table table-borderless mb-0">
            <tr>
              <td><strong>Kullanıcı Adı:</strong></td>
              <td>{{ current_user.username }}</td>
            </tr>
            <tr>
              <td><strong>E-posta:</strong></td>
              <td>{{ current_user.email }}</td>
            </tr>
            <tr>
              <td><strong>Adı:</strong></td>
              <td>{{ current_user.first_name|default:"Belirtilmemiş" }}</td>
            </tr>
            <tr>
              <td><strong>Soyadı:</strong></td>
              <td>{{ current_user.last_name|default:"Belirtilmemiş" }}</td>
            </tr>
            <tr>
              <td><strong>Adı Soyadı:</strong></td>
              <td>{{ current_user.get_full_name|default:"Belirtilmemiş" }}</td>
            </tr>
            <tr>
              <td><strong>Rol:</strong></td>
              <td><span class="badge bg-primary">{{ user_role }}</span></td>
            </tr>
            <tr>
              <td><strong>Hesap Durumu:</strong></td>
              <td>
                {% if current_user.is_active %}
                  <span class="badge bg-success">Aktif</span>
                {% else %}
                  <span class="badge bg-danger">Pasif</span>
                {% endif %}
              </td>
            </tr>
            <tr>
              <td><strong>Kayıt Tarihi:</strong></td>
              <td>{{ current_user.date_joined|date:"d.m.Y H:i" }}</td>
            </tr>
            <tr>
              <td><strong>Son Giriş:</strong></td>
              <td>{{ current_user.last_login|date:"d.m.Y H:i"|default:"Bilinmiyor" }}</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

    <!-- Account Statistics -->
    <div class="col-lg-6 mb-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bi bi-graph-up me-2"></i>Hesap İstatistikleri
          </h5>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-4 border-end">
              <h4 class="text-primary mb-0">{{ total_requests|default:"0" }}</h4>
              <small class="text-muted">Toplam Talep</small>
            </div>
            <div class="col-4 border-end">
              <h4 class="text-success mb-0">{{ resolved_requests|default:"0" }}</h4>
              <small class="text-muted">Çözülen</small>
            </div>
            <div class="col-4">
              <h4 class="text-warning mb-0">{{ pending_requests|default:"0" }}</h4>
              <small class="text-muted">Bekleyen</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="card mt-3">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="bi bi-lightning me-2"></i>Hızlı İşlemler
          </h5>
        </div>
        <div class="card-body">
          <div class="d-grid gap-2">
            <a href="/accounts/customer/profile-edit/" class="btn btn-outline-primary">
              <i class="bi bi-pencil me-2"></i>Profil Bilgilerini Düzenle
            </a>
            <a href="/accounts/customer/change-password/" class="btn btn-outline-warning">
              <i class="bi bi-key me-2"></i>Şifre Değiştir
            </a>
            <a href="/tickets/create/" class="btn btn-outline-success">
              <i class="bi bi-plus-circle me-2"></i>Yeni Talep Oluştur
            </a>
            <a href="/tickets/" class="btn btn-outline-info">
              <i class="bi bi-list me-2"></i>Taleplerime Git
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.table-borderless td {
  padding: 0.5rem 0.75rem;
  border: none;
}

.card {
  border: none;
  box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  transition: all 0.3s ease;
}

.card:hover {
  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
  transform: translateY(-2px);
}

.btn {
  transition: all 0.3s ease;
}

.btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.15);
}
</style>
{% endblock %}